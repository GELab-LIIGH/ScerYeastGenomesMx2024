# **Recreating Figure 3A**
---
## **Inputs:**

| No. | File(s)             | Path                                                                        |Generated by| Used by | Description |
|-----|---------------------|-----------------------------------------------------------------------------|------------|---------|-------------|
|**1.**|{SAMPLE}_CONC.addgp.rmdup.bam` |`pipeline/data/bams/`|A combination between `samtools` and `picard` |`samtools` inside `run.sh`,`overlapping_genesAbove.py`, `ortholog_coverageAll.py`|Genome alignment to a concatenated reference. The index is also necessary.|
|**2.**|`SACE_S288C_v1_allChr.gff`|`pipeline/data/`|Obtained from: [Liti, et.al.](https://yjx1217.github.io/Yeast_PacBio_2016/data/)|`gff2txt.py`|Genome anotation from the species to which the samples belong.|
|**3.**|`SAPA_YPS138_v1.gff`|`pipeline/data/`|Obtained from: [Liti, et.al.](https://yjx1217.github.io/Yeast_PacBio_2016/data/)|`gff2txt.py`|Genome anotation from the species to which the introgressions come from.|
|**4.**|`SACE_S288C_v1_allChr.fna`|`pipeline/data/`|---|`ortholog_coverageAll.py`|Fasta of the species to wich samples belong.|
|**5.**|`SAPA_YPS138_v1.fna`|`pipeline/data/`|---|`ortholog_coverageAll.py`|Fasta of the species to wich the introgressions belong.|
|**6.**|`SAPA_YPS138_v1_subtelomeric_regions.csv`|`pipeline/data/`|Subtelomeric regions obtained by |`ortholog_coverageAll.py`|Coordinates of the S. paradoxus subtelomeric regions.|
|**7.**|`41588_2017_BFng3847_MOESM339_ESM.tsv`|`pipeline/data/`|One to one ortholos obtained by |`ortholog_coverageAll.py`|A list of one to one orthologs between Saccharomyces species.|
|**8.**|`phylogeny.csv`|`pipeline/`|Manually curated. |`graph.R`|IDs of the strains used ant their phylogenetic groups.|
|**9.**|`{SAMPLE}_introSAPA_All_noOrth.csv`|`pipeline/data/introgressions/`|Generated by run.sh during stage1.sh.| trueIntrogressions pipeline. |CSV file with introgressions per sample, includes information about the introgressed gene.|
|**10.**| {SAMPLE}_CONC.g.vcf | `pipeline/trueIntrogressions/data/`| gatk Hapotypecall starting with the bams listed above | `pipeline/trueIntrogressions/Snakefile` and `pipeline/trueIntrogressions/Snakefile`| VCFs obatained after aligning the samples fastqs to the concatenated reference.|

*Note:* All paths are relative to this file, exceptions are signaled by a starting `/`.*

---
## **Scripts:**
| No. | Script             | Output | Description |
|-----|--------------------|--------|-------------|
|**1.**|`run.sh`|No explicit output, runs all pipeline.|
|**2.**|`pipeline/scripts/make_depth_plot.R`|CSVs with the coverage statistics per windows, per reference and per contig.|
|**3.**|`pipeline/scripts/gff2txt.py`|<p>TXT formatted gff containing only genes.</p><p>Bed file with all genes described in the txt mentioned before.</p><p>Index of the bed file mentioned before in tabix format.</p>|
|**4.**|`pipeline/scripts/overlapping_genesAbove.py`|CSVs with coverage from genes.|
|**5.**|`pipeline/scripts/ortholog_coverageAll.py`|CSVs with coverage statistics from introgressions.|
|**6.**|`pipeline/scripts/graph.R`|Graph with the distributions of number of introgressions by phylogenetic group, colored by heterozigosity.|


### *Packages/Dependencies:*
**1.** htslib 1.9

**2.** gcc 5.1.0

**3.** bedtools 2.26

**4.** python 3.7

**5.** samtools 1.9

**6.** r 3.6.1

**7.** bedtools 2.24

**8.** Snakemake 5.10.0

**9.** vcftools 0.1.14

**10.** gatk 4.1.1.0

---
## **Outputs:**
| No. | File | Description |
|-----|------|-------------|
|**1.**|`/pipeline/data/introgressions/fig4A.pdf`|Figure 4A.|
|**2.**|`pipeline/trueIntrogressions/data/phyl/{sample}/Matrix_{intro}_filteredSNP_10missing_biallelic.phy.treefile`|Figure 4A.|

*Note:* Several intermediate files are created but not all of them are stored. Only relevant files are listed above.

---
## **Execution:**
**1.**
```
cd pipeline
bash run.sh
```
