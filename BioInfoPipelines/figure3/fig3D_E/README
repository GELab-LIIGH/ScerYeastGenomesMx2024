# **Recreating Figure 3D & E**
---
## **Inputs:**

| No. | File(s)             | Path                                                                        |Generated by| Used by | Description |
|-----|---------------------|-----------------------------------------------------------------------------|------------|---------|-------------|
|**1.**|MA1_MA2_FG_Alp.csv`|`pipeline/data/`|Manually generated from the full sample sheet|`shared.py`|Sample sheet, only reguires columns "ID" and the phylogenetic groups as "PhyloGroup_SACE469"|
|**2.**|`{SAMPLE}_introSAPA_All_noOrth.csv`|`../fig3A/pipeline/data/introgressions/`|Generated for figure 3A.|`shared.py`|CSV file with introgressions per sample, includes information about the introgressed gene.|


*Note:* All paths are relative to this file, exceptions are signaled by a starting `/`.*

---
## **Scripts:**
| No. | Script             | Path                                                                        | Output | Description |
|-----|--------------------|-----------------------------------------------------------------------------|--------|-------------|
|**1.**|`shared.py`|`pipeline/scripts/`|CSVs with frequencies of each gene in each population normalized and in absolute values.|Searches al introgression files, building the universe of intrgoressed genes and evaluating each gene presence in each population.|
|**2.**|`graph_shared.R`|`pipeline/scripts/`|<p>CSV with the amount of introgressed genes in a population or combination of populations.</p><p>PDFs with figures 3D and 3E</p>|Uses the frequencies in populations to compute how many introgressed genes are shared accross populations and normalizes them.|

### *Packages/Dependencies:*
**1.** Python 3.7

**2.** R 3.6.1

---
## **Outputs:**
| No. | File | Path | Description |
|-----|------|------|-------------|
|**1.**|`frequencies_norm.csv`|`pipeline/data/`|Normalized amount of genes in each combination of populations.|
|**2.**|`frequencies_norm_Singles.pdf`|`pipeline/data/`|Normalized amount of genes only in one population.|
|**3.**|`frequencies_norm_Various.pdf`|`pipeline/data/`|Normalized amount of genes in more tha one population.|

*Note:* Several intermediate files are created but not all of them are stored. Only relevant files are listed above.

---
## **Execution:**
**1.**
```
cd pipeline
python scripts/shared.py -s data/MA1_MA2_FG_Alp.csv -o data/ -f ../../fig3A/pipeline/data/introgressions/ -p MA1MA2FgAlp
Rscript scripts/graph_shared.R
```
